import{d as e,aX as a,b1 as l,aG as r,o as s,r as o,dt as t,c as i,ey as d,aK as n,g as u,f as c,D as p,m,G as g,i as f,w as v,$ as h,E as x,ag as _,e as y,ai as w,ah as b,aQ as C,aJ as V}from"./index.Dv9sjPYC.js";import{E as k,a as j}from"./form-item.DgRMSZzs.js";import{E as M}from"./link.CHuo07Uc.js";import{E as q}from"./checkbox.Cq-dvxYE.js";import{E}from"./text.PvK_Xx8y.js";/* empty css                */import{E as K}from"./popper.m2lNosSJ.js";import{C as U}from"./index.D0MCCphy.js";import"./castArray.D1K_WIrw.js";import"./_baseClone.Br4BWTY9.js";import"./omit.B6E_lyF8.js";const L={"text-center":"","m-0":"","mb-20px":""},z={flex:"","items-center":"","gap-10px":""},R=["src"],A={class:"flex-x-between w-full"},G={"flex-center":"","gap-10px":""},I={class:"third-party-login"},P={class:"divider-container"},Q={class:"divider-text"},S={class:"flex-center gap-x-5 w-full text-[var(--el-text-color-secondary)]"},B=V(e({__name:"Login",emits:["update:modelValue"],setup(e,{emit:V}){const{t:B}=a(),D=l(),F=r();s(()=>Y());const J=o(),X=o(!1),$=o(!1),H=o(),N=t.getRememberMe(),O=o({username:"admin",password:"123456",captchaKey:"",captchaCode:"",rememberMe:N}),T=i(()=>({username:[{required:!0,trigger:"blur",message:B("login.message.username.required")}],password:[{required:!0,trigger:"blur",message:B("login.message.password.required")},{min:6,message:B("login.message.password.min"),trigger:"blur"}],captchaCode:[{required:!0,trigger:"blur",message:B("login.message.captchaCode.required")}]})),W=o(!1);function Y(){W.value=!0,d.getCaptcha().then(e=>{O.value.captchaKey=e.captchaKey,H.value=e.captchaBase64}).finally(()=>W.value=!1)}async function Z(){try{if(!(await(J.value?.validate())))return;X.value=!0,await D.login(O.value);const e=F.query.redirect||"/";await C.push(decodeURIComponent(e))}catch(e){Y()}finally{X.value=!1}}function ee(e){e instanceof KeyboardEvent&&($.value=e.getModifierState("CapsLock"))}const ae=V;function le(e){ae("update:modelValue",e)}return(e,a)=>{const l=n("User"),r=x,s=h,o=k,t=n("Lock"),i=K,d=n("Loading"),C=E,V=q,D=M,F=b,N=j;return c(),u("div",null,[p("h3",L,g(f(B)("login.login")),1),m(N,{ref_key:"loginFormRef",ref:J,model:f(O),rules:f(T),size:"large","validate-on-rule-change":!1},{default:v(()=>[m(o,{prop:"username"},{default:v(()=>[m(s,{modelValue:f(O).username,"onUpdate:modelValue":a[0]||(a[0]=e=>f(O).username=e),modelModifiers:{trim:!0},placeholder:f(B)("login.username")},{prefix:v(()=>[m(r,null,{default:v(()=>[m(l)]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1}),m(i,{visible:f($),content:f(B)("login.capsLock"),placement:"right"},{default:v(()=>[m(o,{prop:"password"},{default:v(()=>[m(s,{modelValue:f(O).password,"onUpdate:modelValue":a[1]||(a[1]=e=>f(O).password=e),modelModifiers:{trim:!0},placeholder:f(B)("login.password"),type:"password","show-password":"",onKeyup:[ee,_(Z,["enter"])]},{prefix:v(()=>[m(r,null,{default:v(()=>[m(t)]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1})]),_:1},8,["visible","content"]),m(o,{prop:"captchaCode"},{default:v(()=>[p("div",z,[m(s,{modelValue:f(O).captchaCode,"onUpdate:modelValue":a[2]||(a[2]=e=>f(O).captchaCode=e),modelModifiers:{trim:!0},placeholder:f(B)("login.captchaCode"),clearable:"",class:"flex-1",onKeyup:_(Z,["enter"])},{prefix:v(()=>[...a[6]||(a[6]=[p("div",{class:"i-svg:captcha"},null,-1)])]),_:1},8,["modelValue","placeholder"]),p("div",{"cursor-pointer":"","h-40px":"","w-120px":"","flex-center":"",onClick:Y},[f(W)?(c(),y(r,{key:0,class:"is-loading",size:"20"},{default:v(()=>[m(d)]),_:1})):f(H)?(c(),u("img",{key:1,"border-rd-4px":"","object-cover":"",shadow:"[0_0_0_1px_var(--el-border-color)_inset]",src:f(H),alt:"captchaCode"},null,8,R)):(c(),y(C,{key:2,type:"info",size:"small"},{default:v(()=>[...a[7]||(a[7]=[w("点击获取验证码",-1)])]),_:1}))])])]),_:1}),p("div",A,[m(V,{modelValue:f(O).rememberMe,"onUpdate:modelValue":a[3]||(a[3]=e=>f(O).rememberMe=e)},{default:v(()=>[w(g(f(B)("login.rememberMe")),1)]),_:1},8,["modelValue"]),m(D,{type:"primary",underline:"never",onClick:a[4]||(a[4]=e=>le("resetPwd"))},{default:v(()=>[w(g(f(B)("login.forgetPassword")),1)]),_:1})]),m(o,null,{default:v(()=>[m(F,{loading:f(X),type:"primary",class:"w-full",onClick:Z},{default:v(()=>[w(g(f(B)("login.login")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"]),p("div",G,[m(C,{size:"default"},{default:v(()=>[w(g(f(B)("login.noAccount")),1)]),_:1}),m(D,{type:"primary",underline:"never",onClick:a[5]||(a[5]=e=>le("register"))},{default:v(()=>[w(g(f(B)("login.reg")),1)]),_:1})]),p("div",I,[p("div",P,[a[8]||(a[8]=p("div",{class:"divider-line"},null,-1)),p("span",Q,g(f(B)("login.otherLoginMethods")),1),a[9]||(a[9]=p("div",{class:"divider-line"},null,-1))]),p("div",S,[m(U,null,{default:v(()=>[...a[10]||(a[10]=[p("div",{"text-20px":"",class:"i-svg:wechat"},null,-1)])]),_:1}),m(U,null,{default:v(()=>[...a[11]||(a[11]=[p("div",{"text-20px":"","cursor-pointer":"",class:"i-svg:qq"},null,-1)])]),_:1}),m(U,null,{default:v(()=>[...a[12]||(a[12]=[p("div",{"text-20px":"","cursor-pointer":"",class:"i-svg:github"},null,-1)])]),_:1}),m(U,null,{default:v(()=>[...a[13]||(a[13]=[p("div",{"text-20px":"","cursor-pointer":"",class:"i-svg:gitee"},null,-1)])]),_:1})])])])}}}),[["__scopeId","data-v-83d2f653"]]);export{B as default};
