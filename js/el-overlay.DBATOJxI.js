import{o as e,P as o,a5 as t,J as n,aj as l,b as a,c as s,H as u,a3 as c,I as d,bw as r,a1 as i,bx as m,a2 as f,by as p,t as v,z as y,d as b,l as g,k as C,a6 as h,v as x,bz as M,bh as w,r as B,bA as k,U as E,F as S,bB as I,a7 as L}from"./index.DbrnSrZI.js";import{P as z}from"./vnode.BtSvcUQj.js";import{t as O,U as A,e as D}from"./use-form-item.Bd6zpZ0e.js";import{a as F}from"./scroll.CM76KvlP.js";import{i as Y}from"./index.4teDAmMz.js";const j=(l,a,s,u)=>{let c={offsetX:0,offsetY:0};const d=e=>{const o=e.clientX,t=e.clientY,{offsetX:a,offsetY:s}=c,d=l.value.getBoundingClientRect(),r=d.left,i=d.top,m=d.width,f=d.height,p=document.documentElement.clientWidth,v=document.documentElement.clientHeight,y=-r+a,b=-i+s,g=p-r-m+a,C=v-i-f+s,h=e=>{let d=a+e.clientX-o,r=s+e.clientY-t;(null==u?void 0:u.value)||(d=Math.min(Math.max(d,y),g),r=Math.min(Math.max(r,b),C)),c={offsetX:d,offsetY:r},l.value&&(l.value.style.transform=`translate(${n(d)}, ${n(r)})`)},x=()=>{document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",x)};document.addEventListener("mousemove",h),document.addEventListener("mouseup",x)},r=()=>{a.value&&l.value&&a.value.removeEventListener("mousedown",d)};return e((()=>{o((()=>{s.value?a.value&&l.value&&a.value.addEventListener("mousedown",d):r()}))})),t((()=>{r()})),{resetPosition:()=>{c={offsetX:0,offsetY:0},l.value&&(l.value.style.transform="none")}}},P=(e,o={})=>{l(e)||O("[useLockscreen]","You need to pass a ref param to this function");const t=o.ns||a("popup"),n=s((()=>t.bm("parent","hidden")));if(!u||c(document.body,n.value))return;let p=0,v=!1,y="0";const b=()=>{setTimeout((()=>{"undefined"!=typeof document&&(f(null==document?void 0:document.body,n.value),v&&document&&(document.body.style.width=y))}),200)};d(e,(e=>{if(!e)return void b();v=!c(document.body,n.value),v&&(y=document.body.style.width),p=F(t.namespace.value);const o=document.documentElement.clientHeight<document.body.scrollHeight,l=r(document.body,"overflowY");p>0&&(o||"scroll"===l)&&v&&(document.body.style.width=`calc(100% - ${p}px)`),i(document.body,n.value)})),m((()=>b()))},T=e=>{if(!e)return{onClick:p,onMousedown:p,onMouseup:p};let o=!1,t=!1;return{onClick:n=>{o&&t&&e(n),o=t=!1},onMousedown:e=>{o=e.target===e.currentTarget},onMouseup:e=>{t=e.target===e.currentTarget}}},$=v({mask:{type:Boolean,default:!0},customMaskEvent:Boolean,overlayClass:{type:y([String,Array,Object])},zIndex:{type:y([String,Number])}});const X=b({name:"ElOverlay",props:$,emits:{click:e=>e instanceof MouseEvent},setup(e,{slots:o,emit:t}){const n=a("overlay"),{onClick:l,onMousedown:s,onMouseup:u}=T(e.customMaskEvent?void 0:e=>{t("click",e)});return()=>e.mask?g("div",{class:[n.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:l,onMousedown:s,onMouseup:u},[C(o,"default")],z.STYLE|z.CLASS|z.PROPS,["onClick","onMouseup","onMousedown"]):h("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[C(o,"default")])}}),N=v({center:Boolean,alignCenter:Boolean,closeIcon:{type:x},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),H={close:()=>!0},R=v({...N,appendToBody:Boolean,appendTo:{type:y([String,Object]),default:"body"},beforeClose:{type:y(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:Boolean,headerAriaLevel:{type:String,default:"2"}}),U={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[A]:e=>M(e),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},V=(o,t)=>{var l;const a=S().emit,{nextZIndex:c}=w();let r="";const i=D(),m=D(),f=B(!1),p=B(!1),v=B(!1),y=B(null!=(l=o.zIndex)?l:c());let b,g;const C=k("namespace",I),h=s((()=>{const e={},t=`--${C.value}-dialog`;return o.fullscreen||(o.top&&(e[`${t}-margin-top`]=o.top),o.width&&(e[`${t}-width`]=n(o.width))),e})),x=s((()=>o.alignCenter?{display:"flex"}:{}));function M(){null==g||g(),null==b||b(),o.openDelay&&o.openDelay>0?({stop:b}=L((()=>F()),o.openDelay)):F()}function z(){null==b||b(),null==g||g(),o.closeDelay&&o.closeDelay>0?({stop:g}=L((()=>j()),o.closeDelay)):j()}function O(){o.beforeClose?o.beforeClose((function(e){e||(p.value=!0,f.value=!1)})):z()}function F(){u&&(f.value=!0)}function j(){f.value=!1}return o.lockScroll&&P(f),d((()=>o.modelValue),(e=>{e?(p.value=!1,M(),v.value=!0,y.value=Y(o.zIndex)?c():y.value++,E((()=>{a("open"),t.value&&(t.value.scrollTop=0)}))):f.value&&z()})),d((()=>o.fullscreen),(e=>{t.value&&(e?(r=t.value.style.transform,t.value.style.transform=""):t.value.style.transform=r)})),e((()=>{o.modelValue&&(f.value=!0,v.value=!0,M())})),{afterEnter:function(){a("opened")},afterLeave:function(){a("closed"),a(A,!1),o.destroyOnClose&&(v.value=!1)},beforeLeave:function(){a("close")},handleClose:O,onModalClick:function(){o.closeOnClickModal&&O()},close:z,doClose:j,onOpenAutoFocus:function(){a("openAutoFocus")},onCloseAutoFocus:function(){a("closeAutoFocus")},onCloseRequested:function(){o.closeOnPressEscape&&O()},onFocusoutPrevented:function(e){var o;"pointer"===(null==(o=e.detail)?void 0:o.focusReason)&&e.preventDefault()},titleId:i,bodyId:m,closed:p,style:h,overlayDialogStyle:x,rendered:v,visible:f,zIndex:y}};export{X as E,U as a,j as b,P as c,R as d,T as e,N as f,H as g,V as u};
