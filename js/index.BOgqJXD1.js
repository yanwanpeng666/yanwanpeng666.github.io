import{d as e,r as l,S as a,o as t,a$ as o,e as s,h as r,B as i,l as d,w as n,g as p,W as u,X as m,V as c,f,j,ax as b}from"./index.B3d8Dmuj.js";import{v as h}from"./el-loading.B1qKZjRP.js";import{E as y}from"./el-dialog.BIT_iI8z.js";import"./el-overlay.DFO6xjsR.js";import{b as v,a as _}from"./el-radio-group.BsfhQCiu.js";/* empty css                 */import{E as g}from"./el-input.g7qu-v5S.js";import{E as k}from"./el-input-number.3lzrKsHs.js";/* empty css               */import{E as V,a as x}from"./el-select.CVxl-A_m.js";import"./el-scrollbar.C2a-duqq.js";import"./el-popper.CBWrSz2w.js";import"./el-tree.BRtxBLwI.js";import"./el-checkbox.C6eKdUkB.js";import{E as w}from"./el-tree-select.C0HacTxg.js";import{E as C}from"./el-card.t0aqapey.js";import{E,a as I}from"./el-table-column.MwnpLqcj.js";import"./el-tooltip.l0sNRNKZ.js";import{E as U,a as q}from"./el-form-item.Ccxqd9VX.js";import{E as F}from"./el-button.Bv8Q2e7m.js";import{D as B}from"./dept.CtuhCXUQ.js";import{E as z}from"./el-message-box.B1uzlLP-.js";import{E as A}from"./index.AklDLJAR.js";import"./index.BEtNIXJ0.js";import"./refs.aVURMvDQ.js";import"./index.CBTk_erf.js";import"./vnode.CJ2I5vtx.js";import"./use-form-item.DH5ATW-n.js";import"./scroll.B1tgehxc.js";import"./index.DNmsiJtL.js";import"./index.fyX6um-q.js";import"./index.bRUuVa1a.js";import"./index.CvoAC8VI.js";import"./token.DWNpOE8r.js";import"./strings.CWMG2Kzx.js";import"./castArray.BRUV2Qo0.js";import"./isEqual.CWZuw94W.js";import"./_Uint8Array.D4E2MRdn.js";import"./debounce.D7EHRBw6.js";import"./_baseIteratee.I3aVY8Vh.js";import"./index.ZW63jOM8.js";import"./index.Xn7qE5Ng.js";import"./validator.CO1hzgSt.js";const D={class:"app-container"},O={class:"search-bar"},R={class:"mb-10px"},T={class:"dialog-footer"},N=e({name:"Dept",inheritAttrs:!1,__name:"index",setup(e){const N=l(U),P=l(U),S=l(!1),W=l([]),X=a({}),$=a({title:"",visible:!1}),J=l(),K=l(),L=a({status:1,parentId:0,sort:1}),M=a({parentId:[{required:!0,message:"上级部门不能为空",trigger:"change"}],name:[{required:!0,message:"部门名称不能为空",trigger:"blur"}],code:[{required:!0,message:"部门编号不能为空",trigger:"blur"}],sort:[{required:!0,message:"显示排序不能为空",trigger:"blur"}]});function Q(){S.value=!0,B.getList(X).then((e=>{J.value=e,S.value=!1}))}function Z(){N.value.resetFields(),Q()}function G(e){W.value=e.map((e=>e.id))}async function H(e,l){const a=await B.getOptions();K.value=[{value:0,label:"顶级部门",children:a}],$.visible=!0,l?($.title="修改部门",B.getFormData(l).then((e=>{Object.assign(L,e)}))):($.title="新增部门",L.parentId=e??0)}function Y(){P.value.validate((e=>{if(e){S.value=!0;const e=L.id;e?B.update(e,L).then((()=>{b.success("修改成功"),le(),Q()})).finally((()=>S.value=!1)):B.add(L).then((()=>{b.success("新增成功"),le(),Q()})).finally((()=>S.value=!1))}}))}function ee(e){const l=[e||W.value].join(",");l?z.confirm("确认删除已选中的数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{S.value=!0,B.deleteByIds(l).then((()=>{b.success("删除成功"),Z()})).finally((()=>S.value=!1))}),(()=>{b.info("已取消删除")})):b.warning("请勾选删除项")}function le(){$.visible=!1,P.value.resetFields(),P.value.clearValidate(),L.id=void 0,L.parentId=0,L.status=1,L.sort=1}return t((()=>{Q()})),(e,l)=>{const a=g,t=q,b=V,B=x,z=F,ae=U,te=E,oe=A,se=I,re=C,ie=w,de=k,ne=v,pe=_,ue=y,me=o("hasPerm"),ce=h;return s(),r("div",D,[i("div",O,[d(ae,{ref_key:"queryFormRef",ref:N,model:p(X),inline:!0},{default:n((()=>[d(t,{label:"关键字",prop:"keywords"},{default:n((()=>[d(a,{modelValue:p(X).keywords,"onUpdate:modelValue":l[0]||(l[0]=e=>p(X).keywords=e),placeholder:"部门名称",onKeyup:u(Q,["enter"])},null,8,["modelValue"])])),_:1}),d(t,{label:"部门状态",prop:"status"},{default:n((()=>[d(B,{modelValue:p(X).status,"onUpdate:modelValue":l[1]||(l[1]=e=>p(X).status=e),placeholder:"全部",clearable:"",class:"!w-[100px]"},{default:n((()=>[d(b,{value:1,label:"正常"}),d(b,{value:0,label:"禁用"})])),_:1},8,["modelValue"])])),_:1}),d(t,null,{default:n((()=>[d(z,{class:"filter-item",type:"primary",icon:"search",onClick:Q},{default:n((()=>l[10]||(l[10]=[m(" 搜索 ")]))),_:1}),d(z,{icon:"refresh",onClick:Z},{default:n((()=>l[11]||(l[11]=[m("重置")]))),_:1})])),_:1})])),_:1},8,["model"])]),d(re,{shadow:"never"},{default:n((()=>[i("div",R,[c((s(),f(z,{type:"success",icon:"plus",onClick:l[2]||(l[2]=e=>H(0,void 0))},{default:n((()=>l[12]||(l[12]=[m(" 新增 ")]))),_:1})),[[me,["sys:dept:add"]]]),c((s(),f(z,{type:"danger",disabled:0===p(W).length,icon:"delete",onClick:l[3]||(l[3]=e=>ee())},{default:n((()=>l[13]||(l[13]=[m(" 删除 ")]))),_:1},8,["disabled"])),[[me,["sys:dept:delete"]]])]),c((s(),f(se,{data:p(J),"row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"},onSelectionChange:G},{default:n((()=>[d(te,{type:"selection",width:"55",align:"center"}),d(te,{prop:"name",label:"部门名称","min-width":"200"}),d(te,{prop:"code",label:"部门编号",width:"200"}),d(te,{prop:"status",label:"状态",width:"100"},{default:n((e=>[1==e.row.status?(s(),f(oe,{key:0,type:"success"},{default:n((()=>l[14]||(l[14]=[m("正常")]))),_:1})):(s(),f(oe,{key:1,type:"info"},{default:n((()=>l[15]||(l[15]=[m("禁用")]))),_:1}))])),_:1}),d(te,{prop:"sort",label:"排序",width:"100"}),d(te,{label:"操作",fixed:"right",align:"left",width:"200"},{default:n((e=>[c((s(),f(z,{type:"primary",link:"",size:"small",icon:"plus",onClick:j((l=>H(e.row.id,void 0)),["stop"])},{default:n((()=>l[16]||(l[16]=[m(" 新增 ")]))),_:2},1032,["onClick"])),[[me,["sys:dept:add"]]]),c((s(),f(z,{type:"primary",link:"",size:"small",icon:"edit",onClick:j((l=>H(e.row.parentId,e.row.id)),["stop"])},{default:n((()=>l[17]||(l[17]=[m(" 编辑 ")]))),_:2},1032,["onClick"])),[[me,["sys:dept:edit"]]]),c((s(),f(z,{type:"danger",link:"",size:"small",icon:"delete",onClick:j((l=>ee(e.row.id)),["stop"])},{default:n((()=>l[18]||(l[18]=[m(" 删除 ")]))),_:2},1032,["onClick"])),[[me,["sys:dept:delete"]]])])),_:1})])),_:1},8,["data"])),[[ce,p(S)]])])),_:1}),d(ue,{modelValue:p($).visible,"onUpdate:modelValue":l[9]||(l[9]=e=>p($).visible=e),title:p($).title,width:"600px",onClosed:le},{footer:n((()=>[i("div",T,[d(z,{type:"primary",onClick:Y},{default:n((()=>l[21]||(l[21]=[m("确 定")]))),_:1}),d(z,{onClick:le},{default:n((()=>l[22]||(l[22]=[m("取 消")]))),_:1})])])),default:n((()=>[d(ae,{ref_key:"deptFormRef",ref:P,model:p(L),rules:p(M),"label-width":"80px"},{default:n((()=>[d(t,{label:"上级部门",prop:"parentId"},{default:n((()=>[d(ie,{modelValue:p(L).parentId,"onUpdate:modelValue":l[4]||(l[4]=e=>p(L).parentId=e),placeholder:"选择上级部门",data:p(K),filterable:"","check-strictly":"","render-after-expand":!1},null,8,["modelValue","data"])])),_:1}),d(t,{label:"部门名称",prop:"name"},{default:n((()=>[d(a,{modelValue:p(L).name,"onUpdate:modelValue":l[5]||(l[5]=e=>p(L).name=e),placeholder:"请输入部门名称"},null,8,["modelValue"])])),_:1}),d(t,{label:"部门编号",prop:"code"},{default:n((()=>[d(a,{modelValue:p(L).code,"onUpdate:modelValue":l[6]||(l[6]=e=>p(L).code=e),placeholder:"请输入部门编号"},null,8,["modelValue"])])),_:1}),d(t,{label:"显示排序",prop:"sort"},{default:n((()=>[d(de,{modelValue:p(L).sort,"onUpdate:modelValue":l[7]||(l[7]=e=>p(L).sort=e),"controls-position":"right",style:{width:"100px"},min:0},null,8,["modelValue"])])),_:1}),d(t,{label:"部门状态"},{default:n((()=>[d(pe,{modelValue:p(L).status,"onUpdate:modelValue":l[8]||(l[8]=e=>p(L).status=e)},{default:n((()=>[d(ne,{label:1},{default:n((()=>l[19]||(l[19]=[m("正常")]))),_:1}),d(ne,{label:0},{default:n((()=>l[20]||(l[20]=[m("禁用")]))),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}});export{N as default};
