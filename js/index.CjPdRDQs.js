import{d as e,r as a,W as l,o as t,cp as s,g as o,f as r,D as i,m as d,w as n,$ as u,ag as p,i as m,ah as c,ai as f,ac as b,e as h,b7 as _,j as y,aS as v,aZ as g}from"./index.Dv9sjPYC.js";import{v as j}from"./loading.S8LTmobk.js";import{E as V,a as k}from"./radio-group.DKuTe-fa.js";import{E as w}from"./input-number.sGCeKMc8.js";import{E as x,a as C}from"./select.D46WCvpG.js";import"./scrollbar.DQblMs23.js";import"./popper.m2lNosSJ.js";import"./tree.Dcl2NF7B.js";import"./checkbox.Cq-dvxYE.js";import"./text.PvK_Xx8y.js";import{E as I}from"./tree-select.BYKNxPD6.js";import{E}from"./card.UCV2TBx1.js";import{a as U,E as q}from"./table-column.D28nzGFS.js";/* empty css                */import{E as D,a as F}from"./form-item.DgRMSZzs.js";import{D as z}from"./dept-api.bH3oIJyj.js";/* empty css                    */import{E as B}from"./index.BqKoy5Fw.js";import"./omit.B6E_lyF8.js";import"./_baseClone.Br4BWTY9.js";import"./index.BlULC2eY.js";import"./strings.BtizHOxT.js";import"./toNumber.P9ps2NTq.js";import"./castArray.D1K_WIrw.js";import"./_baseIteratee.DbpbFJtj.js";import"./index.8lkWLndA.js";import"./index.C5bLMH_j.js";import"./debounce.CITkvERZ.js";import"./raf.B6j8aosc.js";const S={class:"app-container"},A={class:"search-container"},N={class:"data-table__toolbar"},O={class:"data-table__toolbar--actions"},R={class:"dialog-footer"},T=e({name:"Dept",inheritAttrs:!1,__name:"index",setup(e){const T=a(),Z=a(),$=a(!1),K=a([]),L=l({}),P=l({title:"",visible:!1}),Q=a(),W=a(),G=l({status:1,parentId:"0",sort:1}),H=l({parentId:[{required:!0,message:"上级部门不能为空",trigger:"change"}],name:[{required:!0,message:"部门名称不能为空",trigger:"blur"}],code:[{required:!0,message:"部门编号不能为空",trigger:"blur"}],sort:[{required:!0,message:"显示排序不能为空",trigger:"blur"}]});function J(){$.value=!0,z.getList(L).then(e=>{Q.value=e,$.value=!1})}function M(){T.value.resetFields(),J()}function X(e){K.value=e.map(e=>e.id)}async function Y(e,a){const l=await z.getOptions();W.value=[{value:"0",label:"顶级部门",children:l}],P.visible=!0,a?(P.title="修改部门",z.getFormData(a).then(e=>{Object.assign(G,e)})):(P.title="新增部门",G.parentId=e||"0")}function ee(){Z.value.validate(e=>{if(e){$.value=!0;const e=G.id;e?z.update(e,G).then(()=>{g.success("修改成功"),le(),J()}).finally(()=>$.value=!1):z.create(G).then(()=>{g.success("新增成功"),le(),J()}).finally(()=>$.value=!1)}})}function ae(e){const a=[e||K.value].join(",");a?B.confirm("确认删除已选中的数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{$.value=!0,z.deleteByIds(a).then(()=>{g.success("删除成功"),M()}).finally(()=>$.value=!1)},()=>{g.info("已取消删除")}):g.warning("请勾选删除项")}function le(){P.visible=!1,Z.value.resetFields(),Z.value.clearValidate(),G.id=void 0,G.parentId="0",G.status=1,G.sort=1}return t(()=>{J()}),(e,a)=>{const l=u,t=D,g=C,z=x,B=c,te=F,se=q,oe=_,re=U,ie=E,de=I,ne=w,ue=k,pe=V,me=v,ce=s("hasPerm"),fe=j;return r(),o("div",S,[i("div",A,[d(te,{ref_key:"queryFormRef",ref:T,model:m(L),inline:!0},{default:n(()=>[d(t,{label:"关键字",prop:"keywords"},{default:n(()=>[d(l,{modelValue:m(L).keywords,"onUpdate:modelValue":a[0]||(a[0]=e=>m(L).keywords=e),placeholder:"部门名称",onKeyup:p(J,["enter"])},null,8,["modelValue"])]),_:1}),d(t,{label:"部门状态",prop:"status"},{default:n(()=>[d(z,{modelValue:m(L).status,"onUpdate:modelValue":a[1]||(a[1]=e=>m(L).status=e),placeholder:"全部",clearable:"",style:{width:"100px"}},{default:n(()=>[d(g,{value:1,label:"正常"}),d(g,{value:0,label:"禁用"})]),_:1},8,["modelValue"])]),_:1}),d(t,{class:"search-buttons"},{default:n(()=>[d(B,{class:"filter-item",type:"primary",icon:"search",onClick:J},{default:n(()=>[...a[10]||(a[10]=[f(" 搜索 ",-1)])]),_:1}),d(B,{icon:"refresh",onClick:M},{default:n(()=>[...a[11]||(a[11]=[f("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),d(ie,{shadow:"hover",class:"data-table"},{default:n(()=>[i("div",N,[i("div",O,[b((r(),h(B,{type:"success",icon:"plus",onClick:a[2]||(a[2]=e=>Y())},{default:n(()=>[...a[12]||(a[12]=[f(" 新增 ",-1)])]),_:1})),[[ce,["sys:dept:add"]]]),b((r(),h(B,{type:"danger",disabled:0===m(K).length,icon:"delete",onClick:a[3]||(a[3]=e=>ae())},{default:n(()=>[...a[13]||(a[13]=[f(" 删除 ",-1)])]),_:1},8,["disabled"])),[[ce,["sys:dept:delete"]]])])]),b((r(),h(re,{data:m(Q),"row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"},class:"data-table__content",onSelectionChange:X},{default:n(()=>[d(se,{type:"selection",width:"55",align:"center"}),d(se,{prop:"name",label:"部门名称","min-width":"200"}),d(se,{prop:"code",label:"部门编号",width:"200"}),d(se,{prop:"status",label:"状态",width:"100"},{default:n(e=>[1==e.row.status?(r(),h(oe,{key:0,type:"success"},{default:n(()=>[...a[14]||(a[14]=[f("正常",-1)])]),_:1})):(r(),h(oe,{key:1,type:"info"},{default:n(()=>[...a[15]||(a[15]=[f("禁用",-1)])]),_:1}))]),_:1}),d(se,{prop:"sort",label:"排序",width:"100"}),d(se,{label:"操作",fixed:"right",align:"left",width:"200"},{default:n(e=>[b((r(),h(B,{type:"primary",link:"",size:"small",icon:"plus",onClick:y(a=>Y(e.row.id,void 0),["stop"])},{default:n(()=>[...a[16]||(a[16]=[f(" 新增 ",-1)])]),_:1},8,["onClick"])),[[ce,["sys:dept:add"]]]),b((r(),h(B,{type:"primary",link:"",size:"small",icon:"edit",onClick:y(a=>Y(e.row.parentId,e.row.id),["stop"])},{default:n(()=>[...a[17]||(a[17]=[f(" 编辑 ",-1)])]),_:1},8,["onClick"])),[[ce,["sys:dept:edit"]]]),b((r(),h(B,{type:"danger",link:"",size:"small",icon:"delete",onClick:y(a=>ae(e.row.id),["stop"])},{default:n(()=>[...a[18]||(a[18]=[f(" 删除 ",-1)])]),_:1},8,["onClick"])),[[ce,["sys:dept:delete"]]])]),_:1})]),_:1},8,["data"])),[[fe,m($)]])]),_:1}),d(me,{modelValue:m(P).visible,"onUpdate:modelValue":a[9]||(a[9]=e=>m(P).visible=e),title:m(P).title,width:"600px",onClosed:le},{footer:n(()=>[i("div",R,[d(B,{type:"primary",onClick:ee},{default:n(()=>[...a[21]||(a[21]=[f("确 定",-1)])]),_:1}),d(B,{onClick:le},{default:n(()=>[...a[22]||(a[22]=[f("取 消",-1)])]),_:1})])]),default:n(()=>[d(te,{ref_key:"deptFormRef",ref:Z,model:m(G),rules:m(H),"label-width":"80px"},{default:n(()=>[d(t,{label:"上级部门",prop:"parentId"},{default:n(()=>[d(de,{modelValue:m(G).parentId,"onUpdate:modelValue":a[4]||(a[4]=e=>m(G).parentId=e),placeholder:"选择上级部门",data:m(W),filterable:"","check-strictly":"","render-after-expand":!1},null,8,["modelValue","data"])]),_:1}),d(t,{label:"部门名称",prop:"name"},{default:n(()=>[d(l,{modelValue:m(G).name,"onUpdate:modelValue":a[5]||(a[5]=e=>m(G).name=e),placeholder:"请输入部门名称"},null,8,["modelValue"])]),_:1}),d(t,{label:"部门编号",prop:"code"},{default:n(()=>[d(l,{modelValue:m(G).code,"onUpdate:modelValue":a[6]||(a[6]=e=>m(G).code=e),placeholder:"请输入部门编号"},null,8,["modelValue"])]),_:1}),d(t,{label:"显示排序",prop:"sort"},{default:n(()=>[d(ne,{modelValue:m(G).sort,"onUpdate:modelValue":a[7]||(a[7]=e=>m(G).sort=e),"controls-position":"right",style:{width:"100px"},min:0},null,8,["modelValue"])]),_:1}),d(t,{label:"部门状态"},{default:n(()=>[d(pe,{modelValue:m(G).status,"onUpdate:modelValue":a[8]||(a[8]=e=>m(G).status=e)},{default:n(()=>[d(ue,{value:1},{default:n(()=>[...a[19]||(a[19]=[f("正常",-1)])]),_:1}),d(ue,{value:0},{default:n(()=>[...a[20]||(a[20]=[f("禁用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{T as default};
