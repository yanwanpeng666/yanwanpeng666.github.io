import{d as e,bx as a,r as s,J as t,o as l,ap as n,g as u,f as d,m as o,w as r,ai as c,$ as p,aT as i,i as m,ah as f,e as _,b7 as v,D as y,S as b,V as h,n as g,G as k,aJ as V}from"./index.Dv9sjPYC.js";import{a as x,E as j}from"./form-item.DgRMSZzs.js";import{E as w}from"./card.UCV2TBx1.js";import{a as I,E as C}from"./col.BTxHlVsk.js";import{E as S}from"./link.CHuo07Uc.js";import{u as U}from"./useStomp.gBnXjQjw.js";import"./castArray.D1K_WIrw.js";import"./_baseClone.Br4BWTY9.js";const E={class:"app-container"},J={class:"chat-messages-wrapper"},T={key:0,class:"chat-message__content"},W={class:"text-gray-600"},$={key:1},q=V(e({__name:"websocket",setup(e){const V=a(),q=s(void 0),A=s([]),D=s("亲爱的朋友们，系统已恢复最新状态。"),G=s("Hi, "+V.userInfo.username+" 这里是点对点消息示例！"),H=s("root"),{isConnected:N,connect:O,subscribe:Y,disconnect:z}=U({debug:!0});function B(){O()}function F(){z()}function K(){N.value&&(Y("/app/broadcast",()=>{}),A.value.push({sender:V.userInfo.username,content:D.value}))}function L(){N.value&&(Y(`/app/sendToUser/${H.value}`,()=>{}),A.value.push({sender:V.userInfo.username,content:G.value}))}return t(()=>N.value,e=>{e?(Y("/topic/notice",e=>{A.value.push({sender:"Server",content:e.body})}),Y("/user/queue/greeting",e=>{const a=JSON.parse(e.body);A.value.push({sender:a.sender,content:a.content})}),A.value.push({sender:"Server",content:"Websocket 已连接",type:"tip"})):A.value.push({sender:"Server",content:"Websocket 已断开",type:"tip"})}),l(()=>{B()}),n(()=>{F()}),(e,a)=>{const s=S,t=p,l=f,n=I,U=v,O=C,Y=w,z=j,M=x;return d(),u("div",E,[o(s,{href:"https://gitee.com/youlaiorg/vue3-element-admin/blob/master/src/views/demo/websocket.vue",type:"primary",target:"_blank",class:"mb-[20px]"},{default:r(()=>[...a[4]||(a[4]=[c(" 示例源码 请点击>>>> ",-1)])]),_:1}),o(O,{gutter:10},{default:r(()=>[o(n,{span:12},{default:r(()=>[o(Y,null,{default:r(()=>[o(O,null,{default:r(()=>[o(n,{span:18},{default:r(()=>[o(t,{modelValue:m(q),"onUpdate:modelValue":a[0]||(a[0]=e=>i(q)?q.value=e:null),style:{width:"200px"}},null,8,["modelValue"]),o(l,{type:"primary",class:"ml-5",disabled:m(N),onClick:B},{default:r(()=>[...a[5]||(a[5]=[c(" 连接 ",-1)])]),_:1},8,["disabled"]),o(l,{type:"danger",disabled:!m(N),onClick:F},{default:r(()=>[...a[6]||(a[6]=[c(" 断开 ",-1)])]),_:1},8,["disabled"])]),_:1}),o(n,{span:6,class:"text-right"},{default:r(()=>[a[9]||(a[9]=c(" 连接状态： ",-1)),m(N)?(d(),_(U,{key:0,type:"success"},{default:r(()=>[...a[7]||(a[7]=[c("已连接",-1)])]),_:1})):(d(),_(U,{key:1,type:"info"},{default:r(()=>[...a[8]||(a[8]=[c("已断开",-1)])]),_:1}))]),_:1})]),_:1})]),_:1}),o(Y,{class:"mt-5"},{default:r(()=>[o(M,{"label-width":"90px"},{default:r(()=>[o(z,{label:"消息内容"},{default:r(()=>[o(t,{modelValue:m(D),"onUpdate:modelValue":a[1]||(a[1]=e=>i(D)?D.value=e:null),type:"textarea"},null,8,["modelValue"])]),_:1}),o(z,null,{default:r(()=>[o(l,{type:"primary",onClick:K},{default:r(()=>[...a[10]||(a[10]=[c("发送广播",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),o(Y,{class:"mt-5"},{default:r(()=>[o(M,{"label-width":"90px"},{default:r(()=>[o(z,{label:"消息内容"},{default:r(()=>[o(t,{modelValue:m(G),"onUpdate:modelValue":a[2]||(a[2]=e=>i(G)?G.value=e:null),type:"textarea"},null,8,["modelValue"])]),_:1}),o(z,{label:"消息接收人"},{default:r(()=>[o(t,{modelValue:m(H),"onUpdate:modelValue":a[3]||(a[3]=e=>i(H)?H.value=e:null)},null,8,["modelValue"])]),_:1}),o(z,null,{default:r(()=>[o(l,{type:"primary",onClick:L},{default:r(()=>[...a[11]||(a[11]=[c("发送点对点消息",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),o(n,{span:12},{default:r(()=>[o(Y,null,{default:r(()=>[y("div",J,[(d(!0),u(b,null,h(m(A),(e,a)=>(d(),u("div",{key:a,class:g(["tip"===e.type?"system-notice":"chat-message",{"chat-message--sent":e.sender===m(V).userInfo.username,"chat-message--received":e.sender!==m(V).userInfo.username}])},["tip"!=e.type?(d(),u("div",T,[y("div",{class:g({"chat-message__sender":e.sender===m(V).userInfo.username,"chat-message__receiver":e.sender!==m(V).userInfo.username})},k(e.sender),3),y("div",W,k(e.content),1)])):(d(),u("div",$,k(e.content),1))],2))),128))])]),_:1})]),_:1})]),_:1})])}}}),[["__scopeId","data-v-0c87c754"]]);export{q as default};
