import{d as e,br as a,r as s,o as t,e as l,h as n,l as o,w as u,X as r,g as d,aj as i,f as p,B as m,Q as c,R as f,i as v,D as b,bs as _,b9 as y}from"./index.DkormZFh.js";import{a as g,E as h}from"./el-form-item.DpKiwSJD.js";import{E as j}from"./el-card.DlQXwYDg.js";import{a as k,E as x}from"./el-col.CxWKejC8.js";/* empty css               */import{E as V}from"./el-button.DUK_RP8h.js";import{E as w}from"./el-input.CBVPG-Nb.js";import{E as U}from"./el-link.06QYxAc3.js";import{E}from"./index.BLSprckC.js";import{_ as I}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./use-form-item.D8pEeANt.js";import"./castArray.B_Bdywty.js";import"./event.CIKxL71l.js";import"./_Uint8Array.C1eiXyEn.js";import"./index.CW-C8zFE.js";import"./index.2kYytDEb.js";import"./index.COzdzo6n.js";import"./index.B_Br7bXP.js";const S={class:"app-container"},C={class:"message-container"},W={key:0,class:"message-content"},A={class:"color-#333"},R={key:1},B=I(e({__name:"websocket",setup(e){const I=a(),B=s(!1),D=s("wss://api.youlai.tech/ws"),Q=s("root"),X=s([]),q=s("亲爱的大冤种们，由于一只史诗级的BUG，系统版本已经被迫回退到了0.0.1。"),z=s("hi , "+Q.value+" , 我是"+I.userInfo.username+" , 想和你交个朋友 ! ");let G;function H(){G=new _({brokerURL:D.value,connectHeaders:{Authorization:y()},debug:e=>{},onConnect:()=>{B.value=!0,X.value.push({sender:"Server",content:"Websocket 已连接",type:"tip"}),G.subscribe("/topic/notice",(e=>{X.value.push({sender:"Server",content:e.body})})),G.subscribe("/user/queue/greeting",(e=>{const a=JSON.parse(e.body);X.value.push({sender:a.sender,content:a.content})}))},onStompError:e=>{},onDisconnect:()=>{B.value=!1,X.value.push({sender:"Server",content:"Websocket 已断开",type:"tip"})}}),G.activate()}function J(){G&&G.connected&&(G.deactivate(),B.value=!1,X.value.push({sender:"Server",content:"Websocket 已断开",type:"tip"}))}function L(){G.connected&&(G.publish({destination:"/topic/notice",body:q.value}),X.value.push({sender:I.userInfo.username,content:q.value}))}function N(){G.connected&&(G.publish({destination:"/app/sendToUser/"+Q.value,body:z.value}),X.value.push({sender:I.userInfo.username,content:z.value}))}return t((()=>{H()})),(e,a)=>{const s=U,t=w,_=V,y=k,G=E,O=x,T=j,F=g,K=h;return l(),n("div",S,[o(s,{href:"https://gitee.com/youlaiorg/vue3-element-admin/blob/master/src/views/demo/websocket.vue",type:"primary",target:"_blank",class:"mb-[20px]"},{default:u((()=>a[4]||(a[4]=[r(" 示例源码 请点击>>>> ")]))),_:1}),o(O,{gutter:10},{default:u((()=>[o(y,{span:12},{default:u((()=>[o(T,null,{default:u((()=>[o(O,null,{default:u((()=>[o(y,{span:16},{default:u((()=>[o(t,{modelValue:d(D),"onUpdate:modelValue":a[0]||(a[0]=e=>i(D)?D.value=e:null),class:"w-220px"},null,8,["modelValue"]),o(_,{type:"primary",class:"ml-5",disabled:d(B),onClick:H},{default:u((()=>a[5]||(a[5]=[r(" 连接 ")]))),_:1},8,["disabled"]),o(_,{type:"danger",disabled:!d(B),onClick:J},{default:u((()=>a[6]||(a[6]=[r(" 断开 ")]))),_:1},8,["disabled"])])),_:1}),o(y,{span:8,class:"text-right"},{default:u((()=>[a[9]||(a[9]=r(" 连接状态： ")),d(B)?(l(),p(G,{key:0,class:"ml-2",type:"success"},{default:u((()=>a[7]||(a[7]=[r(" 已连接 ")]))),_:1})):(l(),p(G,{key:1,class:"ml-2",type:"info"},{default:u((()=>a[8]||(a[8]=[r("已断开")]))),_:1}))])),_:1})])),_:1})])),_:1}),o(T,{class:"mt-5"},{default:u((()=>[o(K,{"label-width":"90px"},{default:u((()=>[o(F,{label:"消息内容"},{default:u((()=>[o(t,{modelValue:d(q),"onUpdate:modelValue":a[1]||(a[1]=e=>i(q)?q.value=e:null),type:"textarea"},null,8,["modelValue"])])),_:1}),o(F,null,{default:u((()=>[o(_,{type:"primary",onClick:L},{default:u((()=>a[10]||(a[10]=[r("发送广播")]))),_:1})])),_:1})])),_:1})])),_:1}),o(T,{class:"mt-5"},{default:u((()=>[o(K,{"label-width":"90px"},{default:u((()=>[o(F,{label:"消息内容"},{default:u((()=>[o(t,{modelValue:d(z),"onUpdate:modelValue":a[2]||(a[2]=e=>i(z)?z.value=e:null),type:"textarea"},null,8,["modelValue"])])),_:1}),o(F,{label:"消息接收人"},{default:u((()=>[o(t,{modelValue:d(Q),"onUpdate:modelValue":a[3]||(a[3]=e=>i(Q)?Q.value=e:null)},null,8,["modelValue"])])),_:1}),o(F,null,{default:u((()=>[o(_,{type:"primary",onClick:N},{default:u((()=>a[11]||(a[11]=[r(" 发送点对点消息 ")]))),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),o(y,{span:12},{default:u((()=>[o(T,null,{default:u((()=>[m("div",C,[(l(!0),n(c,null,f(d(X),((e,a)=>(l(),n("div",{key:a,class:v({"tip-message":"tip"===e.type,message:"tip"!==e.type,"message--sent":e.sender===d(I).userInfo.username,"message--received":e.sender!==d(I).userInfo.username})},["tip"!=e.type?(l(),n("div",W,[m("div",{class:v({"message-sender":e.sender===d(I).userInfo.username,"message-receiver":e.sender!==d(I).userInfo.username})},b(e.sender),3),m("div",A,b(e.content),1)])):(l(),n("div",R,b(e.content),1))],2)))),128))])])),_:1})])),_:1})])),_:1})])}}}),[["__scopeId","data-v-368affa6"]]);export{B as default};
